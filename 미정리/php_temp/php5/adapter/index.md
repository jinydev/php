---
layout: default
title: Adapter
subtitle: "patterns"

tree: /php
---

### 어뎁터 패턴
---
Adapter 패턴은 매우 단순한 패턴 입니다.
Adapter를 사전적으로 찾아보면 "물건을 다른 것에 맞추어 붙이다,맞추다"라는 의미입니다. 

 프로젝트에서 어뎁터 패턴을 적용한다고 해서 코드의 성능이 개선이 되지는 않습니다. 어뎁터 패턴은 복잡한 객체를 구조를 깔끔하게 정리하는데도 유용한 패턴입니다.

어뎁터 패턴을 이용하게 되면 다른 객체를 자신의 요구사항에 맞추어 사용할 수 있는 패턴입니다.

어뎁터 패턴은 오래된 코드나, 라이브러리를 재사용할 때 매우 빛을 바라는 패턴중의 하나입니다. 오래된 코드들은 새롭게 요구되는 프로젝트와 사용법, 인페이스가 차이점이 있을 수 있습니다.

간단한 예로 한국에서 220V의 가전제품을 일본의 110V로 연결하여 사용하기 위해서 돼지코와 같은 컨버터를 사용하는 것을 생각해 볼 수 있습니다.

어뎁터 패턴은 연선성이 없는 두개의 객체를 묽어서 사용할 수 있도록 도와주는 패턴입니다. 객체와 객체간의 연결 인터페이스를 변경하는 패턴입니다.


또한 어뎁터 패턴은 기존의 함수나, 메소드들의 동작에 문제가 있을 경우에 수정 보정한 패턴등의 코드를 적용할때도 매우 유용합니다.

어뎁터 패턴은 기존 객체를 다른 객체를 통하여 원하는 인터페이스와 동작을 보정할 수 있도록 구조를 개선하는 패턴입니다.
<br>

### 분류
---
어뎁터 패턴은 GOF의 구조적 패턴으로 분류 됩니다.

### 목적
---
기능상으로는 동작하는 코드가 인터페이스의 차이로 인하여 사용할 수 없는 경우 어뎁터 패턴을 사용합니다.
기존의 코드에 오류가 있어, 보정 작업이 필요시에 어뎁터 패턴을 사용합니다.

### 기본실습
---

기본 코드를 통하여 어뎁터 패턴의 동작을 이해해 보도록 하겠습니다.

예를 들어 다음과 같은 값을 계산하는 메소드가 있습니다. 이 메소드는 실수값을 이용하여 계산을 하여 반환합니다.

adapter/01/Math.php
```php
<?php
class Math
{
    // 입력한 값을 2배 증가합니다.
    // 입력값과 반환값은 float형 입니다.
    public function twoTime(float $num):float
    {
        echo "실수 2배 적용합니다.\n";
        return $num*2;
    }

    // 입력한 값을 절반으로 감소 합니다.
    // 입력값과 반환값은 float형 입니다.
    public function halfTime(float $num):float
    {
        echo "실수 1/2배 적용합니다.\n";
        return $num/2;
    }
}
```

하지만 입력되는 값이 정수일때는 어떻게 할까요? 입력된 데이터의 타입이 맞지 않기 때문에 직접적으로 `math` 클래스의 메소드를 사용하기 어렵습니다.

이런경우 기존 메소드 대신에 새로운 아답터를 만들어서 사용을 하면 기존의 `math` 클래스의 메소드를 호출하여 사용할 수 있습니다.

아답터 생성을 위해서 먼저 인터페이스를 생성합니다.

adapter/01/Adapter.php
```php
<?php

interface Adapter
{
    public function twiceOf(int $num):int;
    public function halfOf(int $num):int;
}
```

인터페이스에서 입력된 값을 정수형태로 지정을 하였습니다. 
이제 인터페이스에 대한 구체적인 클래스를 만들어 보도록 합니다.

adapter/01/Object.php
```php
<?php

class Objects implements Adapter
{
    private $_adapter;
    
    function __construct()
    {
        $this->_adapter = new math;
    }

    public function twiceOf(int $num):int
    {
        echo "정수 2배 적용합니다.\n";

        // 캐스팅을 통하여 실수로 변환하여 전달합니다.
        $_num = $this->_adapter->twoTime( (float)$num );

        // 캐스팅을 통하여 정수로 변환하여 반환을 합니다.
        return (int)$_num;
    }

    public function halfOf(int $num):int
    {
        echo "정수 1/2배 적용합니다.\n";

        // 캐스팅을 통하여 실수로 변환하여 전달합니다.
        $_num = $this->_adapter->halfTime( (float)$num );

        // 캐스팅을 통하여 정수로 변환하여 반환을 합니다.
        return (int)$_num;
    }
}
```

아답터 패턴을 이용하여 입력된 값을 실수로 캐스팅하여 이전의 math 클래스의 메소드를 실행하게 됩니다.

이를 적용하여 화면에 출력해 보도록 하겠습니다.

adapter/01/index.php
```php
<?php
    include "Math.php";
    include "Adapter.php";
    include "Object.php";

    $obj = new Objects;

    // 아답터를 이용하여 두배 계산 합니다.
    echo $obj->twiceOf(5);
    echo "\n";

    // 아답터를 이용하여 절반을 계산 합니다.
    echo $obj->halfOf(4);
```  

출력화면 결과 입니다.
```php
$ php index.php
정수 2배 적용합니다.
실수 2배 적용합니다.
10
정수 1/2배 적용합니다.
실수 1/2배 적용합니다.
2
```

<br>

이처럼 아답터 패턴을 이용하게 되면 공동적으로 사용하는 클래스와 메소드를 수정하지 않고 자신이 원하는 형태로 사용이 가능합니다.



### 정리
---

아답터 패턴의 구현은 간단합니다.

어뎁터 패턴은 기존의 코드들을 변환하여 재정의하여 사용을 합니다. 만일 코드를 재정의 하면서 삽입하고자 하거나, 추가해야 되는 코드들은 원래의 코드에서 처리하는 것보다 어텝터 패턴에서 재정의한 코드에서 추가하여 사용하는 것이 좋습니다. 그렇게 하면, 원본의 코드를 수정하지 않고도 프로젝트에 맞는 작업들을 하실 수 있습니다.

아답터 패턴은 브리지 패턴관 유사한 구조를 가지고 있습니다.
하지만 목적적인 측면으로 두개의 패턴을 바라보면 브리지 패턴은 인터페이스와 구현을 분리하여 독립적으로 변경을 할 수 있습니다. 반면 아답터 패턴은 기존에 있는 인터페이스만 변경을 합니다.


